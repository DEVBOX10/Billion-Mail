"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["854"],{2822:function(e,t,r){r.d(t,{Z:()=>o});var a=r(1452),l=r(2398);let o=function(e){return"number"==typeof e||(0,l.Z)(e)&&"[object Number]"==(0,a.Z)(e)}},9506:function(e,t,r){r.d(t,{Z:()=>b});var a=r(5083),l=r(209),o=r(1321),n=r(4124),s=r(2931),i=r(2249),d=r(6253),c=r(3876);let p={gapSmall:"4px 8px",gapMedium:"8px 12px",gapLarge:"12px 16px"},m={name:"Flex",self:function(){return p}},u=Object.assign(Object.assign({},o.Z.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),b=(0,l.aZ)({name:"Flex",props:u,setup(e){let{mergedClsPrefixRef:t,mergedRtlRef:r}=(0,n.ZP)(e),d=(0,o.Z)("Flex","-flex",void 0,m,e,t);return{rtlEnabled:(0,s.V)("Flex",r,t),mergedClsPrefix:t,margin:(0,l.Fl)(()=>{let{size:t}=e;if(Array.isArray(t))return{horizontal:t[0],vertical:t[1]};if("number"==typeof t)return{horizontal:t,vertical:t};let{self:{[(0,i.Tl)("gap",t)]:r}}=d.value,{row:l,col:o}=(0,a.yU)(r);return{horizontal:(0,a.fQ)(o),vertical:(0,a.fQ)(l)}})}},render(){let{vertical:e,reverse:t,align:r,inline:a,justify:o,margin:n,wrap:s,mergedClsPrefix:i,rtlEnabled:p}=this,m=(0,d.x)((0,c.z)(this),!1);return m.length?(0,l.h)("div",{role:"none",class:[`${i}-flex`,p&&`${i}-flex--rtl`],style:{display:a?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:o,flexWrap:!s||e?"nowrap":"wrap",alignItems:r,gap:`${n.vertical}px ${n.horizontal}px`}},m):null}})},6102:function(e,t,r){r.d(t,{Q5:()=>i,Xr:()=>s,ZS:()=>l,_5:()=>n,gI:()=>o,jC:()=>d});var a=r(4203);function l(e){return a.e.get("/batch_mail/task/list",{params:e})}function o(e){return a.e.post("/batch_mail/task/create",e,{fetchOptions:{loading:"Creating task, please wait...",successMessage:!0}})}function n(e){return a.e.post("/batch_mail/task/delete",e,{fetchOptions:{loading:"Deleting task, please wait...",successMessage:!0}})}function s(e){return a.e.post("/batch_mail/task/pause",e,{fetchOptions:{loading:"Pausing task, please wait...",successMessage:!0}})}function i(e){return a.e.post("/batch_mail/task/resume",e,{fetchOptions:{loading:"Resuming task, please wait...",successMessage:!0}})}function d(e){return a.e.post("/batch_mail/task/send_test",e,{fetchOptions:{loading:"Sending test email, please wait...",successMessage:!0}})}},8662:function(e,t,r){r.r(t),r.d(t,{default:()=>T});var a=r(9454),l=r(2403),o=r(2609),n=r(7579),s=r(209),i=r(3447),d=r(3236),c=r(7706),p=r(9506),m=r(3312),u=r(6949),b=r(825),g=r(6102),h=r(7102),k=r(2370),f=r(1321),w=r(4124),v=r(6169),y=r(2249),x=r(6253);function S(e,t="default",r=[]){let{children:a}=e;if(null!==a&&"object"==typeof a&&!Array.isArray(a)){let e=a[t];if("function"==typeof e)return e()}return r}var z=r(3876),_=r(363),$=r(8755);let B={thPaddingBorderedSmall:"8px 12px",thPaddingBorderedMedium:"12px 16px",thPaddingBorderedLarge:"16px 24px",thPaddingSmall:"0",thPaddingMedium:"0",thPaddingLarge:"0",tdPaddingBorderedSmall:"8px 12px",tdPaddingBorderedMedium:"12px 16px",tdPaddingBorderedLarge:"16px 24px",tdPaddingSmall:"0 0 8px 0",tdPaddingMedium:"0 0 12px 0",tdPaddingLarge:"0 0 16px 0"},U={name:"Descriptions",common:$.Z,self:function(e){let{tableHeaderColor:t,textColor2:r,textColor1:a,cardColor:l,modalColor:o,popoverColor:n,dividerColor:s,borderRadius:i,fontWeightStrong:d,lineHeight:c,fontSizeSmall:p,fontSizeMedium:m,fontSizeLarge:u}=e;return Object.assign(Object.assign({},B),{lineHeight:c,fontSizeSmall:p,fontSizeMedium:m,fontSizeLarge:u,titleTextColor:a,thColor:(0,_.h$)(l,t),thColorModal:(0,_.h$)(o,t),thColorPopover:(0,_.h$)(n,t),thTextColor:a,thFontWeight:d,tdTextColor:r,tdColor:l,tdColorModal:o,tdColorPopover:n,borderColor:(0,_.h$)(l,s),borderColorModal:(0,_.h$)(o,s),borderColorPopover:(0,_.h$)(n,s),borderRadius:i})}},W=(0,y.c)([(0,y.cB)("descriptions",{fontSize:"var(--n-font-size)"},[(0,y.cB)("descriptions-separator",`
 display: inline-block;
 margin: 0 8px 0 2px;
 `),(0,y.cB)("descriptions-table-wrapper",[(0,y.cB)("descriptions-table",[(0,y.cB)("descriptions-table-row",[(0,y.cB)("descriptions-table-header",{padding:"var(--n-th-padding)"}),(0,y.cB)("descriptions-table-content",{padding:"var(--n-td-padding)"})])])]),(0,y.u4)("bordered",[(0,y.cB)("descriptions-table-wrapper",[(0,y.cB)("descriptions-table",[(0,y.cB)("descriptions-table-row",[(0,y.c)("&:last-child",[(0,y.cB)("descriptions-table-content",{paddingBottom:0})])])])])]),(0,y.cM)("left-label-placement",[(0,y.cB)("descriptions-table-content",[(0,y.c)("> *",{verticalAlign:"top"})])]),(0,y.cM)("left-label-align",[(0,y.c)("th",{textAlign:"left"})]),(0,y.cM)("center-label-align",[(0,y.c)("th",{textAlign:"center"})]),(0,y.cM)("right-label-align",[(0,y.c)("th",{textAlign:"right"})]),(0,y.cM)("bordered",[(0,y.cB)("descriptions-table-wrapper",`
 border-radius: var(--n-border-radius);
 overflow: hidden;
 background: var(--n-merged-td-color);
 border: 1px solid var(--n-merged-border-color);
 `,[(0,y.cB)("descriptions-table",[(0,y.cB)("descriptions-table-row",[(0,y.c)("&:not(:last-child)",[(0,y.cB)("descriptions-table-content",{borderBottom:"1px solid var(--n-merged-border-color)"}),(0,y.cB)("descriptions-table-header",{borderBottom:"1px solid var(--n-merged-border-color)"})]),(0,y.cB)("descriptions-table-header",`
 font-weight: 400;
 background-clip: padding-box;
 background-color: var(--n-merged-th-color);
 `,[(0,y.c)("&:not(:last-child)",{borderRight:"1px solid var(--n-merged-border-color)"})]),(0,y.cB)("descriptions-table-content",[(0,y.c)("&:not(:last-child)",{borderRight:"1px solid var(--n-merged-border-color)"})])])])])]),(0,y.cB)("descriptions-header",`
 font-weight: var(--n-th-font-weight);
 font-size: 18px;
 transition: color .3s var(--n-bezier);
 line-height: var(--n-line-height);
 margin-bottom: 16px;
 color: var(--n-title-text-color);
 `),(0,y.cB)("descriptions-table-wrapper",`
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[(0,y.cB)("descriptions-table",`
 width: 100%;
 border-collapse: separate;
 border-spacing: 0;
 box-sizing: border-box;
 `,[(0,y.cB)("descriptions-table-row",`
 box-sizing: border-box;
 transition: border-color .3s var(--n-bezier);
 `,[(0,y.cB)("descriptions-table-header",`
 font-weight: var(--n-th-font-weight);
 line-height: var(--n-line-height);
 display: table-cell;
 box-sizing: border-box;
 color: var(--n-th-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),(0,y.cB)("descriptions-table-content",`
 vertical-align: top;
 line-height: var(--n-line-height);
 display: table-cell;
 box-sizing: border-box;
 color: var(--n-td-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[(0,y.cE)("content",`
 transition: color .3s var(--n-bezier);
 display: inline-block;
 color: var(--n-td-text-color);
 `)]),(0,y.cE)("label",`
 font-weight: var(--n-th-font-weight);
 transition: color .3s var(--n-bezier);
 display: inline-block;
 margin-right: 14px;
 color: var(--n-th-text-color);
 `)])])])]),(0,y.cB)("descriptions-table-wrapper",`
 --n-merged-th-color: var(--n-th-color);
 --n-merged-td-color: var(--n-td-color);
 --n-merged-border-color: var(--n-border-color);
 `),(0,y.ko)((0,y.cB)("descriptions-table-wrapper",`
 --n-merged-th-color: var(--n-th-color-modal);
 --n-merged-td-color: var(--n-td-color-modal);
 --n-merged-border-color: var(--n-border-color-modal);
 `)),(0,y.WW)((0,y.cB)("descriptions-table-wrapper",`
 --n-merged-th-color: var(--n-th-color-popover);
 --n-merged-td-color: var(--n-td-color-popover);
 --n-merged-border-color: var(--n-border-color-popover);
 `))]),C="DESCRIPTION_ITEM_FLAG",P=Object.assign(Object.assign({},f.Z.props),{title:String,column:{type:Number,default:3},columns:Number,labelPlacement:{type:String,default:"top"},labelAlign:{type:String,default:"left"},separator:{type:String,default:":"},size:{type:String,default:"medium"},bordered:Boolean,labelClass:String,labelStyle:[Object,String],contentClass:String,contentStyle:[Object,String]}),Z=(0,s.aZ)({name:"Descriptions",props:P,slots:Object,setup(e){let{mergedClsPrefixRef:t,inlineThemeDisabled:r}=(0,w.ZP)(e),a=(0,f.Z)("Descriptions","-descriptions",W,U,e,t),l=(0,s.Fl)(()=>{let{size:t,bordered:r}=e,{common:{cubicBezierEaseInOut:l},self:{titleTextColor:o,thColor:n,thColorModal:s,thColorPopover:i,thTextColor:d,thFontWeight:c,tdTextColor:p,tdColor:m,tdColorModal:u,tdColorPopover:b,borderColor:g,borderColorModal:h,borderColorPopover:k,borderRadius:f,lineHeight:w,[(0,y.Tl)("fontSize",t)]:v,[(0,y.Tl)(r?"thPaddingBordered":"thPadding",t)]:x,[(0,y.Tl)(r?"tdPaddingBordered":"tdPadding",t)]:S}}=a.value;return{"--n-title-text-color":o,"--n-th-padding":x,"--n-td-padding":S,"--n-font-size":v,"--n-bezier":l,"--n-th-font-weight":c,"--n-line-height":w,"--n-th-text-color":d,"--n-td-text-color":p,"--n-th-color":n,"--n-th-color-modal":s,"--n-th-color-popover":i,"--n-td-color":m,"--n-td-color-modal":u,"--n-td-color-popover":b,"--n-border-radius":f,"--n-border-color":g,"--n-border-color-modal":h,"--n-border-color-popover":k}}),o=r?(0,v.F)("descriptions",(0,s.Fl)(()=>{let t="",{size:r,bordered:a}=e;return a&&(t+="a"),t+=r[0]}),l,e):void 0;return{mergedClsPrefix:t,cssVars:r?void 0:l,themeClass:null==o?void 0:o.themeClass,onRender:null==o?void 0:o.onRender,compitableColumn:(0,k.Z)(e,["columns","column"]),inlineThemeDisabled:r}},render(){let e=this.$slots.default,t=e?(0,x.x)(e()):[];t.length;let{contentClass:r,labelClass:a,compitableColumn:l,labelPlacement:o,labelAlign:n,size:i,bordered:d,title:c,cssVars:p,mergedClsPrefix:m,separator:u,onRender:b}=this;null==b||b();let g=t.filter(e=>"object"==typeof e&&!!e&&!Array.isArray(e)&&e.type&&e.type[C]),k=g.reduce((e,t,n)=>{let i=t.props||{},c=g.length-1===n,p=["label"in i?i.label:S(t,"label")],b=[S(t)],h=i.span||1,k=e.span;e.span+=h;let f=i.labelStyle||i["label-style"]||this.labelStyle,w=i.contentStyle||i["content-style"]||this.contentStyle;if("left"===o)d?e.row.push((0,s.h)("th",{class:[`${m}-descriptions-table-header`,a],colspan:1,style:f},p),(0,s.h)("td",{class:[`${m}-descriptions-table-content`,r],colspan:c?(l-k)*2+1:2*h-1,style:w},b)):e.row.push((0,s.h)("td",{class:`${m}-descriptions-table-content`,colspan:c?(l-k)*2:2*h},(0,s.h)("span",{class:[`${m}-descriptions-table-content__label`,a],style:f},[...p,u&&(0,s.h)("span",{class:`${m}-descriptions-separator`},u)]),(0,s.h)("span",{class:[`${m}-descriptions-table-content__content`,r],style:w},b)));else{let t=c?(l-k)*2:2*h;e.row.push((0,s.h)("th",{class:[`${m}-descriptions-table-header`,a],colspan:t,style:f},p)),e.secondRow.push((0,s.h)("td",{class:[`${m}-descriptions-table-content`,r],colspan:t,style:w},b))}return(e.span>=l||c)&&(e.span=0,e.row.length&&(e.rows.push(e.row),e.row=[]),"left"!==o&&e.secondRow.length&&(e.rows.push(e.secondRow),e.secondRow=[])),e},{span:0,row:[],secondRow:[],rows:[]}).rows.map(e=>(0,s.h)("tr",{class:`${m}-descriptions-table-row`},e));return(0,s.h)("div",{style:p,class:[`${m}-descriptions`,this.themeClass,`${m}-descriptions--${o}-label-placement`,`${m}-descriptions--${n}-label-align`,`${m}-descriptions--${i}-size`,d&&`${m}-descriptions--bordered`]},c||this.$slots.header?(0,s.h)("div",{class:`${m}-descriptions-header`},c||(0,z.z)(this,"header")):null,(0,s.h)("div",{class:`${m}-descriptions-table-wrapper`},(0,s.h)("table",{class:`${m}-descriptions-table`},(0,s.h)("tbody",null,"top"===o&&(0,s.h)("tr",{class:`${m}-descriptions-table-row`,style:{visibility:"collapse"}},(0,h.rx)(2*l,(0,s.h)("td",null))),k))))}}),j=(0,s.aZ)({name:"DescriptionsItem",[C]:!0,props:{label:String,span:{type:Number,default:1},labelClass:String,labelStyle:[Object,String],contentClass:String,contentStyle:[Object,String]},slots:Object,render:()=>null}),O=(0,s.aZ)({__name:"TaskDetail",setup(e){let t=(0,s.iH)(null),[r,a]=(0,m.d)({onChangeState:e=>{if(e){let e=a.getState();t.value=e.row}}});return(e,a)=>{let l=d.ZP,o=p.Z;return(0,s.wg)(),(0,s.j4)((0,s.SU)(r),{title:e.$t("market.task.detail.title"),width:600,footer:!1},{default:(0,s.w5)(()=>[(0,s.SU)(t)?((0,s.wg)(),(0,s.j4)(Z,{key:0,"label-placement":"left",bordered:!0,column:1,"label-style":{width:"180px"}},{default:(0,s.w5)(()=>[(0,s.Wm)(j,{label:e.$t("market.task.detail.displayName")},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)((0,s.SU)(t).full_name),1)]),_:1},8,["label"]),(0,s.Wm)(j,{label:e.$t("market.task.detail.sender")},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)((0,s.SU)(t).addresser),1)]),_:1},8,["label"]),(0,s.Wm)(j,{label:e.$t("market.task.detail.subject")},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)((0,s.SU)(t).subject),1)]),_:1},8,["label"]),(0,s.Wm)(j,{label:e.$t("market.task.detail.groups")},{default:(0,s.w5)(()=>[(0,s.Wm)(o,null,{default:(0,s.w5)(()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,s.SU)(t).groups,e=>((0,s.wg)(),(0,s.j4)(l,{key:e.id,size:"small"},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)(e.name),1)]),_:2},1024))),128))]),_:1})]),_:1},8,["label"]),(0,s.Wm)(j,{label:e.$t("market.task.detail.sendTime")},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)((0,s.SU)(b.mr)((0,s.SU)(t).start_time)),1)]),_:1},8,["label"]),(0,s.Wm)(j,{label:e.$t("market.task.detail.unsubscribeLink")},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)(1===(0,s.SU)(t).unsubscribe?e.$t("market.task.detail.yes"):e.$t("market.task.detail.no")),1)]),_:1},8,["label"]),(0,s.Wm)(j,{label:e.$t("market.task.detail.threads")},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)(0===(0,s.SU)(t).threads?e.$t("market.task.detail.auto"):(0,s.SU)(t).threads),1)]),_:1},8,["label"]),(0,s.Wm)(j,{label:e.$t("market.task.detail.remark")},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)((0,s.SU)(t).remark||"--"),1)]),_:1},8,["label"])]),_:1})):(0,s.kq)("",!0)]),_:1},8,["title"])}}});var M=r(5778),R=r(5e3);function A(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,s.lA)(e)}let T=(0,s.aZ)({__name:"index",setup(e){let{t}=(0,M.QT)(),{loading:r,tableParams:h,tableList:k,tableTotal:f,getTableData:w}=(0,u.Z)({loading:!0,immediate:!0,params:{page:1,page_size:10,keyword:""},fetchFn:g.ZS}),v=(0,s.iH)([{key:"create_time",title:t("market.task.columns.time"),width:"14%",minWidth:140,render:e=>(0,b.mr)(e.create_time)},{key:"subject",title:t("market.task.columns.subject"),width:"12%",minWidth:100,ellipsis:{tooltip:!0}},{key:"addresser",title:t("market.task.columns.sender"),minWidth:160,width:"14%",ellipsis:{tooltip:!0}},{key:"recipient_count",title:t("market.task.columns.recipients"),width:"7%",minWidth:80},{key:"success_count",title:t("market.task.columns.success"),width:"7%",minWidth:80},{key:"error_count",title:t("market.task.columns.failed"),width:"7%",minWidth:80,render:e=>(0,s.Wm)(i.ZP,{type:"error",text:!0},{default:()=>[e.error_count]})},{key:"active",title:t("market.task.columns.status"),width:"7%",minWidth:80,render:e=>{let r,a,l;return 0===e.task_process||1===e.pause?(0,s.Wm)(d.ZP,{size:"small",bordered:!1,type:"warning"},A(r=t("market.task.status.pending"))?r:{default:()=>[r]}):1===e.task_process?(0,s.Wm)(d.ZP,{size:"small",bordered:!1,type:"warning"},A(a=t("market.task.status.processing"))?a:{default:()=>[a]}):(0,s.Wm)(d.ZP,{size:"small",bordered:!1,type:"success"},A(l=t("market.task.status.done"))?l:{default:()=>[l]})}},{key:"remark",title:t("market.task.columns.remark"),width:"10%",minWidth:100,ellipsis:{tooltip:!0},render:e=>e.remark||"--"},{key:"progress",title:t("market.task.columns.progress"),minWidth:120,render:e=>(0,s.Wm)("div",{class:"max-w-160px"},[(0,s.Wm)(c.Z,{type:"line",status:"success","indicator-placement":"inside",processing:100!==e.progress,percentage:e.progress,"show-indicator":!1},null)])},{title:t("common.columns.actions"),key:"actions",align:"right",width:160,render:e=>{let r,a;return(0,s.Wm)(p.Z,{inline:!0},{default:()=>[2!==e.task_process&&(0,s.Wm)(i.ZP,{type:"primary",text:!0,onClick:()=>{S(e)}},{default:()=>[1===e.pause?t("market.task.actions.send"):t("market.task.actions.pause")]}),(0,s.Wm)(i.ZP,{type:"primary",text:!0,onClick:()=>{$(e)}},A(r=t("market.task.actions.detail"))?r:{default:()=>[r]}),(0,s.Wm)(i.ZP,{type:"error",text:!0,onClick:()=>{B(e)}},A(a=t("common.actions.delete"))?a:{default:()=>[a]})]})}}]),y=(0,R.tv)(),x=()=>{y.push("/market/task/edit")},S=e=>{(0,b.iG)({title:t("market.task.changeStatus.title",{subject:e.subject}),content:1===e.pause?t("market.task.changeStatus.startConfirm"):t("market.task.changeStatus.pauseConfirm"),onConfirm:async()=>{1===e.pause?await (0,g.Q5)({task_id:e.id}):await (0,g.Xr)({task_id:e.id}),w()}})},[z,_]=(0,m.d)({component:O}),$=e=>{_.setState({row:e}),_.open()},B=e=>{(0,b.iG)({title:t("market.task.delete.title"),content:t("market.task.delete.confirm",{subject:e.subject}),confirmText:t("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,g._5)({id:e.id}),w()}})};return(e,d)=>{let c=n.Z,p=o.Z,m=l.Z,u=a.Z;return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(u,null,{toolsLeft:(0,s.w5)(()=>[(0,s.Wm)((0,s.SU)(i.ZP),{type:"primary",onClick:x},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)((0,s.SU)(t)("market.task.actions.add")),1)]),_:1})]),toolsRight:(0,s.w5)(()=>[(0,s.Wm)(c,{value:(0,s.SU)(h).keyword,"onUpdate:value":d[0]||(d[0]=e=>(0,s.SU)(h).keyword=e),width:320,placeholder:(0,s.SU)(t)("market.task.search.subjectPlaceholder"),onSearch:d[1]||(d[1]=()=>(0,s.SU)(w)(!0))},null,8,["value","placeholder"])]),table:(0,s.w5)(()=>[(0,s.Wm)(p,{bordered:!1,loading:(0,s.SU)(r),columns:(0,s.SU)(v),data:(0,s.SU)(k)},null,8,["loading","columns","data"])]),pageRight:(0,s.w5)(()=>[(0,s.Wm)(m,{page:(0,s.SU)(h).page,"onUpdate:page":d[2]||(d[2]=e=>(0,s.SU)(h).page=e),"page-size":(0,s.SU)(h).page_size,"onUpdate:pageSize":d[3]||(d[3]=e=>(0,s.SU)(h).page_size=e),"item-count":(0,s.SU)(f),onRefresh:(0,s.SU)(w)},null,8,["page","page-size","item-count","onRefresh"])]),modal:(0,s.w5)(()=>[(0,s.Wm)((0,s.SU)(z))]),_:1})])}}})}}]);