"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["82"],{8774:function(e,a,l){l.r(a),l.d(a,{default:()=>L});var t=l(9454),i=l(2403),o=l(6419),n=l(6988),s=l(209);let u=(0,s.aZ)({__name:"index",props:(0,s.Vf)({width:{default:240},prefix:{type:Boolean,default:!1}},{value:{default:""},valueModifiers:{}}),emits:(0,s.Vf)(["search"],["update:value"]),setup(e,a){let{expose:l,emit:t}=a,i=(0,s.iH)(null),o=(0,s.tT)(e,"value"),u=()=>{t("search",o.value)};return l({focus:()=>{var e;null===(e=i.value)||void 0===e||e.focus()}}),(e,a)=>{let l=n.Z;return(0,s.wg)(),(0,s.j4)(l,(0,s.dG)({ref_key:"inputRef",ref:i,value:o.value,"onUpdate:value":a[0]||(a[0]=e=>o.value=e)},e.$attrs,{class:"bt-search",style:{width:`${e.width}px`},onKeyup:(0,s.D2)(u,["enter"])}),(0,s.Nv)({_:2},[e.prefix?{name:"prefix",fn:(0,s.w5)(()=>[(0,s._)("div",{class:"flex items-center cursor-pointer",onClick:u},a[1]||(a[1]=[(0,s._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"0"}:void 0,e.prefix?void 0:{name:"suffix",fn:(0,s.w5)(()=>[(0,s._)("div",{class:"flex items-center cursor-pointer",onClick:u},a[2]||(a[2]=[(0,s._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"1"}]),1040,["value","style"])}}});var d=l(3447),r=l(3567),m=l(9506),p=l(825),c=l(3312),v=l(3776),f=l(6949),w=l(4203);let{t:x}=l(4958).Z.global,b=e=>w.e.get("/mailbox/list",{params:e}),U=e=>w.e.post("/mailbox/create",e,{fetchOptions:{loading:x("mailbox.api.loading.creating"),successMessage:!0}}),_=e=>w.e.post("/mailbox/update",e,{fetchOptions:{loading:x("mailbox.api.loading.updating"),successMessage:!0}}),h=e=>w.e.post("/mailbox/delete",e,{fetchOptions:{loading:x("mailbox.api.loading.deleting"),successMessage:!0}});var S=l(5476);let g={class:"flex"},y={class:"w-0 flex-1 flex items-center"},W={class:"min-w-0"},k=(0,s.aZ)({__name:"index",props:{value:{default:""}},setup(e){let{copyText:a}=(0,v.F)(),l=(0,s.iH)(!1),t=(0,s.Fl)(()=>l.value?e.value:"**********"),i=()=>{l.value=!l.value},o=async()=>{a(`${e.value}`)};return(e,a)=>{let n=S.ZP;return(0,s.wg)(),(0,s.iD)("div",g,[(0,s._)("div",y,[(0,s._)("div",W,[(0,s.Wm)(n,{class:"max-w-full",tooltip:{contentStyle:{maxWidth:"200px"}}},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)((0,s.SU)(t)),1)]),_:1})]),(0,s._)("div",{class:"ml-6px text-15px cursor-pointer",title:"Show",onClick:i},[(0,s._)("i",{class:(0,s.C_)((0,s.SU)(l)?"i-mdi-eye-outline":"i-mdi-eye-off-outline")},null,2)]),(0,s._)("div",{class:"reset ml-6px text-15px cursor-pointer text-#333",title:"Copy",onClick:o},a[0]||(a[0]=[(0,s._)("i",{class:"i-mdi-content-copy"},null,-1)]))])])}}});var Z=l(5891),q=l(55),C=l(5778);let A=(0,s.aZ)({__name:"DomainSelect",props:(0,s.Vf)({isAll:{type:Boolean,default:!0}},{value:{default:()=>null},valueModifiers:{}}),emits:["update:value"],setup(e){let{t:a}=(0,C.QT)(),l=(0,s.tT)(e,"value"),t=(0,s.iH)(!1),i=(0,s.iH)([]);return(async()=>{try{t.value=!0;let o=await (0,q.LC)();(0,p.kJ)(o)&&(i.value=o.map(e=>({label:e.domain,value:e.domain})),e.isAll?(i.value.unshift({label:a("common.all.text"),value:""}),l.value=""):o.length>0&&!l.value&&(l.value=o[0].domain))}finally{t.value=!1}})(),(e,o)=>{let n=Z.Z;return(0,s.wg)(),(0,s.j4)(n,{value:l.value,"onUpdate:value":o[0]||(o[0]=e=>l.value=e),loading:(0,s.SU)(t),filterable:!0,options:(0,s.SU)(i),placeholder:(0,s.SU)(a)("mailbox.domain.selectPlaceholder")},null,8,["value","loading","options","placeholder"])}}}),T=(0,l(4222).default)(A,[["__scopeId","data-v-59ecdb27"]]);var z=l(5523),B=l(4603),E=l(6883),M=l(3858);let P={class:"w-280px"},F={class:"w-280px"},j={class:"w-280px"},G={class:"w-280px"},O=(0,s.aZ)({__name:"MailboxForm",setup(e){let{t:a}=(0,C.QT)(),l=(0,s.iH)(!1),t=(0,s.Fl)(()=>l.value?a("mailbox.form.editTitle"):a("mailbox.form.addTitle")),i=(0,s.AE)("formRef"),o=(0,s.qj)({quota:5,unit:"GB",isAdmin:0,full_name:"",domain:null,password:"",active:1}),u=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],d=[{label:a("mailbox.userType.general"),value:0},{label:a("mailbox.userType.admin"),value:1}],m={full_name:{trigger:"blur",validator:()=>""!==o.full_name.trim()&&!!o.domain||Error(a("mailbox.validation.emailRequired"))},password:{trigger:"blur",validator:()=>{if(l.value){if(o.password&&o.password.trim().length<8)return Error(a("mailbox.validation.passwordLength"));if(o.password&&!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(o.password))return Error(a("mailbox.validation.passwordFormat"))}else{if(o.password.trim().length<8)return Error(a("mailbox.validation.passwordLength"));if(!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(o.password))return Error(a("mailbox.validation.passwordFormat"))}return!0}}},v=(e,a)=>{switch(a){case"GB":e*=1024;case"MB":e*=1048576}return e},f=()=>({full_name:o.full_name,domain:o.domain||"",password:o.password,quota:v(o.quota,o.unit),isAdmin:o.isAdmin,active:o.active}),[w,x]=(0,c.d)({onChangeState:e=>{if(e){let e=x.getState(),{row:a}=e;if(l.value=e.isEdit,a){o.full_name=a.full_name,o.domain=a.domain,o.isAdmin=a.is_admin,o.active=a.active;let[e,l]=(0,p.UO)(a.quota).split(" ");o.quota=(0,p.Dx)(e),o.unit=l}}else o.full_name="",o.domain=null,o.password="",o.quota=5,o.unit="GB",o.isAdmin=0,o.active=1},onConfirm:async()=>{var e;await (null===(e=i.value)||void 0===e?void 0:e.validate());let a=f();l.value?await _(a):await U(a),x.getState().refresh()}});return(e,p)=>{let c=n.Z,v=M.Z,f=E.ZP,x=B.Z,b=Z.Z,U=r.Z,_=z.Z;return(0,s.wg)(),(0,s.j4)((0,s.SU)(w),{title:(0,s.SU)(t),width:"520"},{default:(0,s.w5)(()=>[(0,s.Wm)(_,{ref_key:"formRef",ref:i,class:"pt-20px",model:(0,s.SU)(o),rules:m},{default:(0,s.w5)(()=>[(0,s.Wm)(f,{label:(0,s.SU)(a)("mailbox.form.emailAddress"),path:"full_name"},{default:(0,s.w5)(()=>[(0,s._)("div",P,[(0,s.Wm)(v,null,{default:(0,s.w5)(()=>[(0,s.Wm)(c,{value:(0,s.SU)(o).full_name,"onUpdate:value":p[0]||(p[0]=e=>(0,s.SU)(o).full_name=e),class:"flex-1",disabled:(0,s.SU)(l)},null,8,["value","disabled"]),(0,s.Wm)(T,{value:(0,s.SU)(o).domain,"onUpdate:value":p[1]||(p[1]=e=>(0,s.SU)(o).domain=e),class:"flex-1","is-all":!1,disabled:(0,s.SU)(l)},null,8,["value","disabled"])]),_:1})])]),_:1},8,["label"]),(0,s.Wm)(f,{label:(0,s.SU)(a)("mailbox.form.password"),path:"password"},{default:(0,s.w5)(()=>[(0,s._)("div",F,[(0,s.Wm)(c,{value:(0,s.SU)(o).password,"onUpdate:value":p[2]||(p[2]=e=>(0,s.SU)(o).password=e),placeholder:(0,s.SU)(a)("mailbox.form.passwordPlaceholder")},null,8,["value","placeholder"])])]),_:1},8,["label"]),(0,s.Wm)(f,{label:(0,s.SU)(a)("mailbox.form.quota"),path:"quota"},{default:(0,s.w5)(()=>[(0,s._)("div",j,[(0,s.Wm)(v,null,{default:(0,s.w5)(()=>[(0,s.Wm)(x,{value:(0,s.SU)(o).quota,"onUpdate:value":p[3]||(p[3]=e=>(0,s.SU)(o).quota=e),class:"flex-1",min:1,"show-button":!1},null,8,["value"]),(0,s.Wm)(b,{value:(0,s.SU)(o).unit,"onUpdate:value":p[4]||(p[4]=e=>(0,s.SU)(o).unit=e),class:"flex-1",options:u},null,8,["value"])]),_:1})])]),_:1},8,["label"]),(0,s.Wm)(f,{label:(0,s.SU)(a)("mailbox.form.userType"),path:"userType"},{default:(0,s.w5)(()=>[(0,s._)("div",G,[(0,s.Wm)(b,{value:(0,s.SU)(o).isAdmin,"onUpdate:value":p[5]||(p[5]=e=>(0,s.SU)(o).isAdmin=e),options:d},null,8,["value"])])]),_:1},8,["label"]),(0,s.Wm)(f,{label:(0,s.SU)(a)("mailbox.form.status")},{default:(0,s.w5)(()=>[(0,s.Wm)(U,{value:(0,s.SU)(o).active,"onUpdate:value":p[6]||(p[6]=e=>(0,s.SU)(o).active=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])}}}),R={class:"p-24px"},H={class:"mb-20px text-24px font-bold"},D={class:"w-220px"};function $(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,s.lA)(e)}let L=(0,s.aZ)({__name:"index",setup(e){let{t:a}=(0,C.QT)(),{copyText:l}=(0,v.F)(),{tableParams:n,tableList:w,loading:x,tableTotal:U,getTableData:S}=(0,f.Z)({loading:!0,immediate:!1,params:{page:1,page_size:10,domain:null,keyword:""},fetchFn:b}),g=(0,s.iH)([{key:"username",title:a("mailbox.columns.username"),minWidth:120,ellipsis:{tooltip:!0}},{key:"password",title:a("mailbox.columns.password"),width:"18%",minWidth:120,render:e=>(0,s.Wm)(k,{value:e.password||"--"},null)},{key:"login",title:a("mailbox.columns.loginInfo"),render:e=>{let t;return(0,s.Wm)(d.ZP,{text:!0,type:"primary",onClick:()=>{l(a("mailbox.loginInfo.template",{webmail:window.location.origin+"/roundcube",username:e.username,password:e.password}))}},$(t=a("common.actions.copy"))?t:{default:()=>[t]})}},{key:"quota",title:a("mailbox.columns.quota"),width:"14%",minWidth:120,render:e=>(0,p.UO)(e.quota)},{key:"is_admin",title:a("mailbox.columns.type"),width:"14%",minWidth:100,render:e=>1===e.is_admin?a("mailbox.userType.admin"):a("mailbox.userType.general")},{key:"status",title:a("mailbox.columns.status"),width:"12%",minWidth:80,render:e=>(0,s.Wm)(r.Z,{value:e.active,"checked-value":1,"unchecked-value":0,size:"small",onUpdateValue:a=>{q(e,a)}},null)},{title:a("common.columns.actions"),key:"actions",align:"right",width:120,render:e=>{let l,t;return(0,s.Wm)(m.Z,{inline:!0},{default:()=>[(0,s.Wm)(d.ZP,{type:"primary",text:!0,onClick:()=>{A(e)}},$(l=a("common.actions.edit"))?l:{default:()=>[l]}),(0,s.Wm)(d.ZP,{type:"error",text:!0,onClick:()=>{z(e)}},$(t=a("common.actions.delete"))?t:{default:()=>[t]})]})}}]),[y,W]=(0,c.d)({component:O,state:{isEdit:!1,refresh:S}}),Z=()=>{W.setState({isEdit:!1,row:null}),W.open()},q=async(e,a)=>{await _({full_name:e.full_name,domain:e.domain,password:e.password,quota:e.quota,isAdmin:e.is_admin,active:a}),e.active=a},A=e=>{W.setState({isEdit:!0,row:e}),W.open()},z=e=>{(0,p.iG)({title:a("mailbox.delete.title"),content:a("mailbox.delete.confirm",{name:e.username}),confirmText:a("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await h({email:e.username}),S()}})};return(e,l)=>{let r=o.Z,m=i.Z,p=t.Z;return(0,s.wg)(),(0,s.iD)("div",R,[(0,s._)("div",H,(0,s.zw)((0,s.SU)(a)("mailbox.title")),1),(0,s.Wm)(p,null,{toolsLeft:(0,s.w5)(()=>[(0,s.Wm)((0,s.SU)(d.ZP),{type:"primary",onClick:Z},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)((0,s.SU)(a)("mailbox.actions.add")),1)]),_:1})]),toolsRight:(0,s.w5)(()=>[(0,s._)("div",D,[(0,s.Wm)(T,{value:(0,s.SU)(n).domain,"onUpdate:value":[l[0]||(l[0]=e=>(0,s.SU)(n).domain=e),l[1]||(l[1]=()=>(0,s.SU)(S)(!0))]},null,8,["value"])]),(0,s.Wm)(u,{value:(0,s.SU)(n).keyword,"onUpdate:value":l[2]||(l[2]=e=>(0,s.SU)(n).keyword=e),width:"280",placeholder:(0,s.SU)(a)("mailbox.search.usernamePlaceholder"),onSearch:l[3]||(l[3]=()=>(0,s.SU)(S)(!0))},null,8,["value","placeholder"])]),table:(0,s.w5)(()=>[(0,s.Wm)(r,{loading:(0,s.SU)(x),columns:(0,s.SU)(g),data:(0,s.SU)(w)},null,8,["loading","columns","data"])]),pageRight:(0,s.w5)(()=>[(0,s.Wm)(m,{page:(0,s.SU)(n).page,"onUpdate:page":l[4]||(l[4]=e=>(0,s.SU)(n).page=e),"page-size":(0,s.SU)(n).page_size,"onUpdate:pageSize":l[5]||(l[5]=e=>(0,s.SU)(n).page_size=e),"item-count":(0,s.SU)(U),onRefresh:l[6]||(l[6]=()=>(0,s.SU)(S)(!0))},null,8,["page","page-size","item-count"])]),modal:(0,s.w5)(()=>[(0,s.Wm)((0,s.SU)(y))]),_:1})])}}})}}]);