"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["339"],{55:function(e,a,l){l.d(a,{Au:()=>m,Fj:()=>s,LC:()=>n,OV:()=>r,dj:()=>u,gK:()=>d,i7:()=>o,v1:()=>p,yW:()=>c});var t=l(4203);let{t:i}=l(4958).Z.global,o=e=>t.e.get("/domains/list",{params:e}),n=()=>t.e.get("/domains/all"),s=e=>t.e.post("/domains/create",e,{fetchOptions:{loading:i("domain.api.loading.creating"),successMessage:!0}}),d=e=>t.e.post("/domains/update",e,{fetchOptions:{loading:i("domain.api.loading.updating"),successMessage:!0}}),u=e=>t.e.post("/domains/delete",e,{fetchOptions:{loading:i("domain.api.loading.deleting"),successMessage:!0}}),r=e=>t.e.post("/domains/set_ssl",e,{fetchOptions:{loading:i("domain.api.loading.settingSSL"),successMessage:!0}}),m=e=>t.e.get("/domains/get_ssl",{params:e}),p=e=>t.e.post("/domains/fresh_dns_records",e,{fetchOptions:{loading:i("domain.api.loading.refreshingDns"),successMessage:!0}}),c=e=>t.e.post("/ssl/apply_cert",e,{fetchOptions:{loading:i("domain.api.loading.applyingCert"),successMessage:!0}})},4361:function(e,a,l){l.d(a,{EV:()=>s,Ts:()=>n,WS:()=>d,iC:()=>o});var t=l(4203);let{t:i}=l(4958).Z.global,o=e=>t.e.get("/mailbox/list",{params:e}),n=e=>t.e.post("/mailbox/create",e,{fetchOptions:{loading:i("mailbox.api.loading.creating"),successMessage:!0}}),s=e=>t.e.post("/mailbox/update",e,{fetchOptions:{loading:i("mailbox.api.loading.updating"),successMessage:!0}}),d=e=>t.e.post("/mailbox/delete",e,{fetchOptions:{loading:i("mailbox.api.loading.deleting"),successMessage:!0}})},3776:function(e,a,l){l.d(a,{F:()=>n});var t=l(825),i=l(4059),o=l(4958);let n=()=>{let{t:e}=o.Z.global,{copy:a,isSupported:l}=(0,i.VPI)({legacy:!0});return{copyText:async i=>{if(!i){t.v0.error(e("common.useCopy.noText"));return}l.value?(await a(i),t.v0.success(e("common.useCopy.success"))):t.v0.error(e("common.useCopy.failed"))}}}},5523:function(e,a,l){l.d(a,{Z:()=>o});var t=l(9833),i=l(209);let o=(0,i.aZ)({__name:"index",props:{model:{},rules:{},labelWidth:{default:"130"},labelPlacement:{default:"left"}},setup(e,a){let{expose:l}=a,o=(0,i.iH)(null);return l({validate:()=>{var e;return null===(e=o.value)||void 0===e?void 0:e.validate()},restoreValidation:()=>{var e;return null===(e=o.value)||void 0===e?void 0:e.restoreValidation()}}),(e,a)=>{let l=t.Z;return(0,i.wg)(),(0,i.j4)(l,(0,i.dG)(e.$attrs,{ref_key:"formRef",ref:o,model:e.model,rules:e.rules,"label-width":e.labelWidth,"label-placement":e.labelPlacement,"show-require-mark":!1}),{default:(0,i.w5)(()=>[(0,i.WI)(e.$slots,"default")]),_:3},16,["model","rules","label-width","label-placement"])}}})},2884:function(e,a,l){l.r(a),l.d(a,{default:()=>V});var t=l(9454),i=l(2403),o=l(2609),n=l(7579),s=l(209),d=l(3447),u=l(3567),r=l(9506),m=l(825),p=l(3312),c=l(3776),v=l(6949),f=l(4361),g=l(5476);let w={class:"flex"},b={class:"w-0 flex-1 flex items-center"},x={class:"min-w-0"},h=(0,s.aZ)({__name:"index",props:{value:{default:""}},setup(e){let{copyText:a}=(0,c.F)(),l=(0,s.iH)(!1),t=(0,s.Fl)(()=>l.value?e.value:"**********"),i=()=>{l.value=!l.value},o=async()=>{a(`${e.value}`)};return(e,a)=>{let n=g.ZP;return(0,s.wg)(),(0,s.iD)("div",w,[(0,s._)("div",b,[(0,s._)("div",x,[(0,s.Wm)(n,{class:"max-w-full",tooltip:{contentStyle:{maxWidth:"200px"}}},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)((0,s.SU)(t)),1)]),_:1})]),(0,s._)("div",{class:"ml-6px text-15px cursor-pointer",title:"Show",onClick:i},[(0,s._)("i",{class:(0,s.C_)((0,s.SU)(l)?"i-mdi-eye-outline":"i-mdi-eye-off-outline")},null,2)]),(0,s._)("div",{class:"reset ml-6px text-15px cursor-pointer text-#333",title:"Copy",onClick:o},a[0]||(a[0]=[(0,s._)("i",{class:"i-mdi-content-copy"},null,-1)]))])])}}});var U=l(5891),S=l(55),_=l(5778);let y=(0,s.aZ)({__name:"DomainSelect",props:(0,s.Vf)({isAll:{type:Boolean,default:!0}},{value:{default:()=>null},valueModifiers:{}}),emits:["update:value"],setup(e){let{t:a}=(0,_.QT)(),l=(0,s.tT)(e,"value"),t=(0,s.iH)(!1),i=(0,s.iH)([]);return(async()=>{try{t.value=!0;let o=await (0,S.LC)();(0,m.kJ)(o)&&(i.value=o.map(e=>({label:e.domain,value:e.domain})),e.isAll?(i.value.unshift({label:a("common.all.text"),value:""}),l.value=""):o.length>0&&!l.value&&(l.value=o[0].domain))}finally{t.value=!1}})(),(e,o)=>{let n=U.Z;return(0,s.wg)(),(0,s.j4)(n,{value:l.value,"onUpdate:value":o[0]||(o[0]=e=>l.value=e),loading:(0,s.SU)(t),filterable:!0,options:(0,s.SU)(i),placeholder:(0,s.SU)(a)("mailbox.domain.selectPlaceholder")},null,8,["value","loading","options","placeholder"])}}}),W=(0,l(4222).default)(y,[["__scopeId","data-v-59ecdb27"]]);var Z=l(5523),k=l(4603),C=l(6883),q=l(3858),T=l(8454);let A={class:"w-280px"},M={class:"w-280px"},O={class:"w-280px"},E={class:"w-280px"},z=(0,s.aZ)({__name:"MailboxForm",setup(e){let{t:a}=(0,_.QT)(),l=(0,s.iH)(!1),t=(0,s.Fl)(()=>l.value?a("mailbox.form.editTitle"):a("mailbox.form.addTitle")),i=(0,s.AE)("formRef"),o=(0,s.qj)({quota:5,unit:"GB",isAdmin:0,full_name:"",domain:null,password:"",active:1}),n=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],d=[{label:a("mailbox.userType.general"),value:0},{label:a("mailbox.userType.admin"),value:1}],r={full_name:{trigger:"blur",validator:()=>""!==o.full_name.trim()&&!!o.domain||Error(a("mailbox.validation.emailRequired"))},password:{trigger:"blur",validator:()=>{if(l.value){if(o.password&&o.password.trim().length<8)return Error(a("mailbox.validation.passwordLength"));if(o.password&&!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(o.password))return Error(a("mailbox.validation.passwordFormat"))}else{if(o.password.trim().length<8)return Error(a("mailbox.validation.passwordLength"));if(!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(o.password))return Error(a("mailbox.validation.passwordFormat"))}return!0}}},c=(e,a)=>{switch(a){case"GB":e*=1024;case"MB":e*=1048576}return e},v=()=>({full_name:o.full_name,domain:o.domain||"",password:o.password,quota:c(o.quota,o.unit),isAdmin:o.isAdmin,active:o.active}),[g,w]=(0,p.d)({onChangeState:e=>{if(e){let e=w.getState(),{row:a}=e;if(l.value=e.isEdit,a){o.full_name=a.full_name,o.domain=a.domain,o.isAdmin=a.is_admin,o.active=a.active;let[e,l]=(0,m.UO)(a.quota).split(" ");o.quota=(0,m.Dx)(e),o.unit=l}}else o.full_name="",o.domain=null,o.password="",o.quota=5,o.unit="GB",o.isAdmin=0,o.active=1},onConfirm:async()=>{var e;await (null===(e=i.value)||void 0===e?void 0:e.validate());let a=v();l.value?await (0,f.EV)(a):await (0,f.Ts)(a),w.getState().refresh()}});return(e,m)=>{let p=T.Z,c=q.Z,v=C.ZP,f=k.Z,w=U.Z,b=u.Z,x=Z.Z;return(0,s.wg)(),(0,s.j4)((0,s.SU)(g),{title:(0,s.SU)(t),width:"520"},{default:(0,s.w5)(()=>[(0,s.Wm)(x,{ref_key:"formRef",ref:i,model:(0,s.SU)(o),rules:r},{default:(0,s.w5)(()=>[(0,s.Wm)(v,{label:(0,s.SU)(a)("mailbox.form.emailAddress"),path:"full_name"},{default:(0,s.w5)(()=>[(0,s._)("div",A,[(0,s.Wm)(c,null,{default:(0,s.w5)(()=>[(0,s.Wm)(p,{value:(0,s.SU)(o).full_name,"onUpdate:value":m[0]||(m[0]=e=>(0,s.SU)(o).full_name=e),class:"flex-1",disabled:(0,s.SU)(l)},null,8,["value","disabled"]),(0,s.Wm)(W,{value:(0,s.SU)(o).domain,"onUpdate:value":m[1]||(m[1]=e=>(0,s.SU)(o).domain=e),class:"flex-1","is-all":!1,disabled:(0,s.SU)(l)},null,8,["value","disabled"])]),_:1})])]),_:1},8,["label"]),(0,s.Wm)(v,{label:(0,s.SU)(a)("mailbox.form.password"),path:"password"},{default:(0,s.w5)(()=>[(0,s._)("div",M,[(0,s.Wm)(p,{value:(0,s.SU)(o).password,"onUpdate:value":m[2]||(m[2]=e=>(0,s.SU)(o).password=e),placeholder:(0,s.SU)(a)("mailbox.form.passwordPlaceholder")},null,8,["value","placeholder"])])]),_:1},8,["label"]),(0,s.Wm)(v,{label:(0,s.SU)(a)("mailbox.form.quota"),path:"quota"},{default:(0,s.w5)(()=>[(0,s._)("div",O,[(0,s.Wm)(c,null,{default:(0,s.w5)(()=>[(0,s.Wm)(f,{value:(0,s.SU)(o).quota,"onUpdate:value":m[3]||(m[3]=e=>(0,s.SU)(o).quota=e),class:"flex-1",min:1,"show-button":!1},null,8,["value"]),(0,s.Wm)(w,{value:(0,s.SU)(o).unit,"onUpdate:value":m[4]||(m[4]=e=>(0,s.SU)(o).unit=e),class:"flex-1",options:n},null,8,["value"])]),_:1})])]),_:1},8,["label"]),(0,s.Wm)(v,{label:(0,s.SU)(a)("mailbox.form.userType"),path:"userType"},{default:(0,s.w5)(()=>[(0,s._)("div",E,[(0,s.Wm)(w,{value:(0,s.SU)(o).isAdmin,"onUpdate:value":m[5]||(m[5]=e=>(0,s.SU)(o).isAdmin=e),options:d},null,8,["value"])])]),_:1},8,["label"]),(0,s.Wm)(v,{label:(0,s.SU)(a)("mailbox.form.status"),"show-feedback":!1},{default:(0,s.w5)(()=>[(0,s.Wm)(b,{value:(0,s.SU)(o).active,"onUpdate:value":m[6]||(m[6]=e=>(0,s.SU)(o).active=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])}}}),P={class:"p-24px"},F={class:"mb-20px text-24px font-bold"},j={class:"w-220px"};function B(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,s.lA)(e)}let V=(0,s.aZ)({__name:"index",setup(e){let{t:a}=(0,_.QT)(),{copyText:l}=(0,c.F)(),{tableParams:g,tableList:w,loading:b,tableTotal:x,getTableData:U}=(0,v.Z)({loading:!0,immediate:!1,params:{page:1,page_size:10,domain:null,keyword:""},fetchFn:f.iC}),S=(0,s.iH)([{key:"username",title:a("mailbox.columns.username"),minWidth:120,ellipsis:{tooltip:!0}},{key:"password",title:a("mailbox.columns.password"),width:"18%",minWidth:120,render:e=>(0,s.Wm)(h,{value:e.password||"--"},null)},{key:"login",title:a("mailbox.columns.loginInfo"),render:e=>{let t;return(0,s.Wm)(d.ZP,{text:!0,type:"primary",onClick:()=>{l(a("mailbox.loginInfo.template",{webmail:window.location.origin+"/roundcube",username:e.username,password:e.password}))}},B(t=a("common.actions.copy"))?t:{default:()=>[t]})}},{key:"quota",title:a("mailbox.columns.quota"),width:"14%",minWidth:120,render:e=>(0,m.UO)(e.quota)},{key:"is_admin",title:a("mailbox.columns.type"),width:"14%",minWidth:100,render:e=>1===e.is_admin?a("mailbox.userType.admin"):a("mailbox.userType.general")},{key:"status",title:a("mailbox.columns.status"),width:"12%",minWidth:80,render:e=>(0,s.Wm)(u.Z,{value:e.active,"checked-value":1,"unchecked-value":0,size:"small",onUpdateValue:a=>{C(e,a)}},null)},{title:a("common.columns.actions"),key:"actions",align:"right",width:120,render:e=>{let l,t;return(0,s.Wm)(r.Z,{inline:!0},{default:()=>[(0,s.Wm)(d.ZP,{type:"primary",text:!0,onClick:()=>{q(e)}},B(l=a("common.actions.edit"))?l:{default:()=>[l]}),(0,s.Wm)(d.ZP,{type:"error",text:!0,onClick:()=>{T(e)}},B(t=a("common.actions.delete"))?t:{default:()=>[t]})]})}}]),[y,Z]=(0,p.d)({component:z,state:{isEdit:!1,refresh:U}}),k=()=>{Z.setState({isEdit:!1,row:null}),Z.open()},C=async(e,a)=>{await (0,f.EV)({full_name:e.full_name,domain:e.domain,password:e.password,quota:e.quota,isAdmin:e.is_admin,active:a}),e.active=a},q=e=>{Z.setState({isEdit:!0,row:e}),Z.open()},T=e=>{(0,m.iG)({title:a("mailbox.delete.title"),content:a("mailbox.delete.confirm",{name:e.username}),confirmText:a("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,f.WS)({email:e.username}),U()}})};return(e,l)=>{let u=n.Z,r=o.Z,m=i.Z,p=t.Z;return(0,s.wg)(),(0,s.iD)("div",P,[(0,s._)("div",F,(0,s.zw)((0,s.SU)(a)("mailbox.title")),1),(0,s.Wm)(p,null,{toolsLeft:(0,s.w5)(()=>[(0,s.Wm)((0,s.SU)(d.ZP),{type:"primary",onClick:k},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)((0,s.SU)(a)("mailbox.actions.add")),1)]),_:1})]),toolsRight:(0,s.w5)(()=>[(0,s._)("div",j,[(0,s.Wm)(W,{value:(0,s.SU)(g).domain,"onUpdate:value":[l[0]||(l[0]=e=>(0,s.SU)(g).domain=e),l[1]||(l[1]=()=>(0,s.SU)(U)(!0))]},null,8,["value"])]),(0,s.Wm)(u,{value:(0,s.SU)(g).keyword,"onUpdate:value":l[2]||(l[2]=e=>(0,s.SU)(g).keyword=e),width:"280",placeholder:(0,s.SU)(a)("mailbox.search.usernamePlaceholder"),onSearch:l[3]||(l[3]=()=>(0,s.SU)(U)(!0))},null,8,["value","placeholder"])]),table:(0,s.w5)(()=>[(0,s.Wm)(r,{loading:(0,s.SU)(b),columns:(0,s.SU)(S),data:(0,s.SU)(w)},null,8,["loading","columns","data"])]),pageRight:(0,s.w5)(()=>[(0,s.Wm)(m,{page:(0,s.SU)(g).page,"onUpdate:page":l[4]||(l[4]=e=>(0,s.SU)(g).page=e),"page-size":(0,s.SU)(g).page_size,"onUpdate:pageSize":l[5]||(l[5]=e=>(0,s.SU)(g).page_size=e),"item-count":(0,s.SU)(x),onRefresh:(0,s.SU)(U)},null,8,["page","page-size","item-count","onRefresh"])]),modal:(0,s.w5)(()=>[(0,s.Wm)((0,s.SU)(y))]),_:1})])}}})}}]);