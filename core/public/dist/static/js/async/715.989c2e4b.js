"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["715"],{2822:function(e,t,a){a.d(t,{Z:()=>o});var n=a(1452),l=a(2398);let o=function(e){return"number"==typeof e||(0,l.Z)(e)&&"[object Number]"==(0,n.Z)(e)}},9506:function(e,t,a){a.d(t,{Z:()=>g});var n=a(5083),l=a(209),o=a(1321),r=a(4124),i=a(2931),c=a(2249),s=a(6253),u=a(3876);let p={gapSmall:"4px 8px",gapMedium:"8px 12px",gapLarge:"12px 16px"},d={name:"Flex",self:function(){return p}},m=Object.assign(Object.assign({},o.Z.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),g=(0,l.aZ)({name:"Flex",props:m,setup(e){let{mergedClsPrefixRef:t,mergedRtlRef:a}=(0,r.ZP)(e),s=(0,o.Z)("Flex","-flex",void 0,d,e,t);return{rtlEnabled:(0,i.V)("Flex",a,t),mergedClsPrefix:t,margin:(0,l.Fl)(()=>{let{size:t}=e;if(Array.isArray(t))return{horizontal:t[0],vertical:t[1]};if("number"==typeof t)return{horizontal:t,vertical:t};let{self:{[(0,c.Tl)("gap",t)]:a}}=s.value,{row:l,col:o}=(0,n.yU)(a);return{horizontal:(0,n.fQ)(o),vertical:(0,n.fQ)(l)}})}},render(){let{vertical:e,reverse:t,align:a,inline:n,justify:o,margin:r,wrap:i,mergedClsPrefix:c,rtlEnabled:p}=this,d=(0,s.x)((0,u.z)(this),!1);return d.length?(0,l.h)("div",{role:"none",class:[`${c}-flex`,p&&`${c}-flex--rtl`],style:{display:n?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:o,flexWrap:!i||e?"nowrap":"wrap",alignItems:a,gap:`${r.vertical}px ${r.horizontal}px`}},d):null}})},1625:function(e,t,a){a.d(t,{WH:()=>r,hI:()=>o,iE:()=>s,mD:()=>c,sS:()=>i,vi:()=>u});var n=a(4203);let{t:l}=a(4958).Z.global,o=e=>n.e.get("/contact/group/list",{params:e}),r=()=>n.e.get("/contact/group/all"),i=e=>n.e.post("/contact/group/create",e,{fetchOptions:{loading:l("contacts.group.loading.createGroup"),successMessage:!0}}),c=e=>n.e.post("/contact/group/update",e,{fetchOptions:{loading:l("contacts.group.loading.updateGroup"),successMessage:!0}}),s=e=>n.e.post("/contact/group/delete",e,{fetchOptions:{loading:l("contacts.group.loading.deleteGroup"),successMessage:!0}}),u=e=>n.e.post("/contact/group/contact_count",e)},5101:function(e,t,a){a.r(t),a.d(t,{default:()=>P});var n=a(9454),l=a(2403),o=a(2609),r=a(7579),i=a(209),c=a(3447),s=a(9506),u=a(3312),p=a(6949),d=a(825),m=a(1625),g=a(5523),f=a(919),h=a(6883),v=a(8454),_=a(5822),S=a(5778);let w={class:"pt-12px"},U={class:"w-240px"},y={class:"w-360px"},x={class:"mt-16px text-desc"},b={class:"mr-4px"},Z={class:"mt-8px text-desc"},W=(0,i.aZ)({__name:"GroupAdd",setup(e){let{t}=(0,S.QT)(),a=(0,i.AE)("formRef"),n=(0,i.qj)({create_type:2,name:"",file_data:"",file_type:""}),l={name:{required:!0,message:t("contacts.group.form.nameRequired"),trigger:"blur"}},o=e=>{let t=new FileReader;t.onload=t=>{var a;n.file_type=e.name.substring(e.name.lastIndexOf(".")+1),n.file_data=null===(a=t.target)||void 0===a?void 0:a.result},e.file&&t.readAsText(e.file)},r=async()=>{await (0,_.Sv)({file_path:"/opt/Billion-Mail/data/example_recipients.txt"})},[s,p]=(0,u.d)({onChangeState:e=>{e&&(n.name="")},onConfirm:async()=>{var e;await (null===(e=a.value)||void 0===e?void 0:e.validate()),await (0,m.sS)((0,i.IU)(n));let t=p.getState();null==t||t.refresh()}});return(e,u)=>{let p=v.Z,d=h.ZP,m=f.Z,_=c.ZP,S=g.Z;return(0,i.wg)(),(0,i.j4)((0,i.SU)(s),{title:(0,i.SU)(t)("contacts.group.add.title"),width:"580"},{default:(0,i.w5)(()=>[(0,i._)("div",w,[(0,i.Wm)(S,{ref_key:"formRef",ref:a,model:(0,i.SU)(n),rules:l},{default:(0,i.w5)(()=>[(0,i.Wm)(d,{label:(0,i.SU)(t)("contacts.group.form.name"),path:"name"},{default:(0,i.w5)(()=>[(0,i._)("div",U,[(0,i.Wm)(p,{value:(0,i.SU)(n).name,"onUpdate:value":u[0]||(u[0]=e=>(0,i.SU)(n).name=e)},null,8,["value"])])]),_:1},8,["label"]),(0,i.Wm)(d,{label:(0,i.SU)(t)("contacts.group.form.file"),path:"file_data"},{default:(0,i.w5)(()=>[(0,i._)("div",y,[(0,i.Wm)(m,{"is-upload":!1,accept:["txt"],onChange:o}),(0,i._)("div",x,[(0,i._)("span",b,(0,i.zw)((0,i.SU)(t)("contacts.group.fileUpload.hint")),1),(0,i.Wm)(_,{text:"",type:"primary",onClick:r},{default:(0,i.w5)(()=>[(0,i.Uk)((0,i.zw)(e.$t("common.actions.download")),1)]),_:1})]),(0,i._)("div",Z,(0,i.zw)((0,i.SU)(t)("contacts.group.fileUpload.emptyHint")),1)])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}}),k={class:"pt-12px"},z={class:"w-240px"},C=(0,i.aZ)({__name:"GroupRename",setup(e){let{t}=(0,S.QT)(),a=(0,i.AE)("formRef"),n=(0,i.qj)({group_id:0,name:""}),l={name:{required:!0,message:t("contacts.group.form.nameRequired"),trigger:"blur"}},[o,r]=(0,u.d)({onChangeState:e=>{if(e){let{row:e}=r.getState();e&&(n.group_id=e.id,n.name=e.name)}else n.group_id=0,n.name=""},onConfirm:async()=>{var e;await (null===(e=a.value)||void 0===e?void 0:e.validate()),await (0,m.mD)((0,i.IU)(n));let t=r.getState();null==t||t.refresh()}});return(e,r)=>{let c=v.Z,s=h.ZP,u=g.Z;return(0,i.wg)(),(0,i.j4)((0,i.SU)(o),{title:(0,i.SU)(t)("contacts.group.rename.title"),width:"480"},{default:(0,i.w5)(()=>[(0,i._)("div",k,[(0,i.Wm)(u,{ref_key:"formRef",ref:a,model:(0,i.SU)(n),rules:l},{default:(0,i.w5)(()=>[(0,i.Wm)(s,{label:(0,i.SU)(t)("contacts.group.form.name"),path:"name"},{default:(0,i.w5)(()=>[(0,i._)("div",z,[(0,i.Wm)(c,{value:(0,i.SU)(n).name,"onUpdate:value":r[0]||(r[0]=e=>(0,i.SU)(n).name=e)},null,8,["value"])])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}});var j=a(5e3);function R(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,i.lA)(e)}let P=(0,i.aZ)({__name:"index",setup(e){let{t}=(0,S.QT)(),a=(0,j.tv)(),{tableParams:g,tableList:f,loading:h,tableTotal:v,getTableData:_}=(0,p.Z)({loading:!0,immediate:!0,params:{page:1,page_size:10,keyword:""},fetchFn:m.hI}),w=(0,i.iH)([{key:"name",title:t("contacts.group.columns.name"),minWidth:120,render:e=>(0,i.Wm)(c.ZP,{text:!0,type:"primary",onClick:()=>{a.push({path:"/contacts/subscribers",state:{group_id:e.id}})}},{default:()=>[e.name]})},{key:"total_count",title:t("contacts.group.columns.subscribers"),minWidth:100,render:e=>e.total_count||0},{key:"unsubscribe_count",title:t("contacts.group.columns.unsubscribe"),minWidth:100,render:e=>e.unsubscribe_count||0},{key:"create_time",title:t("contacts.group.columns.createdAt"),minWidth:140,render:e=>(0,d.mr)(e.create_time)},{title:t("common.columns.actions"),key:"actions",align:"right",width:120,render:e=>{let a,n;return(0,i.Wm)(s.Z,{inline:!0},{default:()=>[(0,i.Wm)(c.ZP,{type:"primary",text:!0,onClick:()=>{k(e)}},R(a=t("common.actions.rename"))?a:{default:()=>[a]}),(0,i.Wm)(c.ZP,{type:"error",text:!0,onClick:()=>{z(e)}},R(n=t("common.actions.delete"))?n:{default:()=>[n]})]})}}]),[U,y]=(0,u.d)({component:W,state:{refresh:_}}),x=()=>{y.open()},[b,Z]=(0,u.d)({component:C,state:{refresh:_}}),k=e=>{Z.setState({row:e}),Z.open()},z=e=>{(0,d.iG)({title:t("contacts.group.delete.title"),content:t("contacts.group.delete.confirm",{name:e.name}),confirmText:t("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,m.iE)({group_ids:[e.id]}),_()}})};return(e,a)=>{let s=r.Z,u=o.Z,p=l.Z,d=n.Z;return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(d,null,{toolsLeft:(0,i.w5)(()=>[(0,i.Wm)((0,i.SU)(c.ZP),{type:"primary",onClick:x},{default:(0,i.w5)(()=>[(0,i.Uk)((0,i.zw)((0,i.SU)(t)("common.actions.add")),1)]),_:1})]),toolsRight:(0,i.w5)(()=>[(0,i.Wm)(s,{value:(0,i.SU)(g).keyword,"onUpdate:value":a[0]||(a[0]=e=>(0,i.SU)(g).keyword=e),width:280,placeholder:(0,i.SU)(t)("contacts.group.search.namePlaceholder"),onSearch:a[1]||(a[1]=()=>(0,i.SU)(_)(!0))},null,8,["value","placeholder"])]),table:(0,i.w5)(()=>[(0,i.Wm)(u,{loading:(0,i.SU)(h),columns:(0,i.SU)(w),data:(0,i.SU)(f)},null,8,["loading","columns","data"])]),pageRight:(0,i.w5)(()=>[(0,i.Wm)(p,{page:(0,i.SU)(g).page,"onUpdate:page":a[2]||(a[2]=e=>(0,i.SU)(g).page=e),"page-size":(0,i.SU)(g).page_size,"onUpdate:pageSize":a[3]||(a[3]=e=>(0,i.SU)(g).page_size=e),"item-count":(0,i.SU)(v),onRefresh:(0,i.SU)(_)},null,8,["page","page-size","item-count","onRefresh"])]),modal:(0,i.w5)(()=>[(0,i.Wm)((0,i.SU)(U)),(0,i.Wm)((0,i.SU)(b))]),_:1})])}}})}}]);